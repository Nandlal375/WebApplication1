DataBase Name => colleage

CREATE DATABASE colleage
CREATE TABLE Employee(EmpId int not null identity(1,1), EmpName varchar(100), salary int)

INSERT INTO Employee(EmpName, salary) values ('ram', 5000)
INSERT INTO Employee(EmpName, salary) values ('ram1', 6000)
INSERT INTO Employee(EmpName, salary) values ('ram2', 7000)
INSERT INTO Employee(EmpName, salary) values ('ram3', 8000)
INSERT INTO Employee(EmpName, salary) values ('ram4', 9000)

Select * from Employee
SELECT MAX(salary) from Employee where salary < (select max(salary) from Employee)

SELECT * from Employee as t1 where 2 = (select count(*) from Employee t2 where t1.salary <= t2.salary)

select top 1 * from 
(SELECT top 4 * FROM Employee order by salary desc) as temp order by salary


select *, ROW_NUMBER() over(partition by salary ORDER by salary) as rnum from Employee

select * from 
(select *, ROW_NUMBER() over(ORDER by salary DESC) as rnum from Employee)as temp
where rnum = 2

---Cumulative sum----

-----Alternative row find even row------------
select * from Employee where EmpId % 2 = 0

-----Alternative row find odd row------------
select * from Employee where EmpId % 2 = 1

---Cumulative sum salary----
SELECT e1.EmpId,
       e1.Salary,
	   e1.EmpName,
       (SELECT SUM(e2.Salary)
        FROM Employee e2
        WHERE e2.EmpId <= e1.EmpId) AS CumulativeSalary
FROM Employee e1;


---self join-------
SELECT A1.EmpId, A1.EmpName, A1.salary FROM Employee as A1,
Employee as A2 where A1.EmpId = A2.EmpId














